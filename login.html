<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Login</title>
</head>
<body>
  <h2>Login</h2>
  <input id="email" type="email" placeholder="you@example.com" />
  <button id="send">Send login link</button>
  <p id="msg"></p>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <script>
    const msg = document.getElementById("msg");
    const btn = document.getElementById("send");

    // 1) Prove the click handler is running
    btn.addEventListener("click", async () => {
      msg.textContent = "Button clicked. Sending...";
      console.log("Button clicked");

      // 2) Prove Supabase library loaded
      console.log("supabase global is:", typeof supabase);

      const SUPABASE_URL = "PASTE_YOUR_PROJECT_URL";
      const SUPABASE_ANON_KEY = "PASTE_YOUR_ANON_PUBLIC_KEY"; // must be anon

      try {
        const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        const email = document.getElementById("email").value.trim();
        if (!email) {
          msg.textContent = "Please enter your email.";
          return;
        }

        const { error } = await sb.auth.signInWithOtp({
          email,
          options: {
            emailRedirectTo: "https://riashandilya-svg.github.io/classicbollywoodmelodies/"
          }
        });

        if (error) {
          msg.textContent = "Error: " + error.message;
          console.log("Supabase error:", error);
        } else {
          msg.textContent = "Sent! Check your inbox/spam.";
          console.log("OTP email sent");
        }
      } catch (e) {
        msg.textContent = "JS error: " + (e && e.message ? e.message : e);
        console.log("JS exception:", e);
      }
    });
  </script>
</body>
</html>

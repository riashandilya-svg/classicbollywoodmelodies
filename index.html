<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ria Om Shandilya</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@500;600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg: #ffffff;
      --surface: rgba(255,255,255,0.82);
      --text: #1A1A1F;
      --muted: rgba(26,26,31,0.70);
      --border: rgba(140, 120, 160, 0.18);
      --shadow: 0 18px 44px rgba(22, 10, 35, 0.10);
      --btnText: #2b1140;
    }

    *{ box-sizing: border-box; }

    body{
      margin: 0;
      min-height: 100vh;
      color: var(--text);
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;

      background:
        radial-gradient(900px 520px at 20% 0%, rgba(255,120,160,0.28), transparent 60%),
        radial-gradient(900px 520px at 85% 10%, rgba(155,110,255,0.26), transparent 62%),
        radial-gradient(780px 480px at 50% 80%, rgba(255,80,90,0.16), transparent 60%),
        radial-gradient(520px 320px at 35% 55%, rgba(255,90,210,0.14), transparent 60%),
        var(--bg);
    }

    .banner{
      position: sticky;
      top: 0;
      z-index: 9999;
      height: 64px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255,255,255,0.72);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid rgba(140,120,160,0.18);
    }

    .banner-link{
      font-family: "Cormorant Garamond", serif;
      font-weight: 600;
      font-size: 22px;
      letter-spacing: 0.7px;
      color: inherit;
      text-decoration: none;
      padding: 8px 12px;
      border-radius: 12px;
    }
    .banner-link:hover{ text-decoration: underline; }

    /* ===== NEW: Welcome ribbon (between banner and h1) ===== */
    .welcome-wrap{
      max-width: 980px;
      margin: 14px auto 0;
      padding: 0 18px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .welcome-ribbon{
      display: none; /* shown only when logged in */
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 12px 16px;
      border-radius: 999px;
      border: 1px solid rgba(155,110,255,0.22);
      background: rgba(255,255,255,0.68);
      backdrop-filter: blur(10px);
      box-shadow: 0 14px 40px rgba(22,10,35,0.08);
      position: relative;
      overflow: hidden;
      width: fit-content;
      max-width: 100%;
    }

    .welcome-ribbon::before{
      content:"";
      position:absolute;
      inset:-60px -80px auto auto;
      width: 220px;
      height: 220px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%,
        rgba(255,120,160,0.36),
        rgba(155,110,255,0.24),
        rgba(255,90,210,0.14),
        transparent 62%);
      pointer-events:none;
    }

    .welcome-ribbon > *{ position: relative; z-index: 1; }

    .welcome-title{
      font-family: "Cormorant Garamond", serif;
      font-weight: 600;
      font-size: 18px;
      letter-spacing: 0.2px;
      white-space: nowrap;
    }

    .welcome-name{
      font-weight: 700;
      color: rgba(43,17,64,0.92);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: min(360px, 60vw);
    }

    /* ===== NEW: Quick links pill (Dashboard + Verify) ===== */
    .quicklinks{
      position: fixed;
      right: 16px;
      top: 80px;               /* below banner */
      z-index: 9998;
      display: none;           /* shown only when logged in */
      gap: 8px;
      align-items: center;
      padding: 10px 10px;
      border-radius: 999px;
      border: 1px solid rgba(140,120,160,0.18);
      background: rgba(255,255,255,0.70);
      backdrop-filter: blur(12px);
      box-shadow: 0 14px 40px rgba(22,10,35,0.10);
    }

    .ql-label{
      font-size: 12px;
      font-weight: 700;
      color: rgba(26,26,31,0.66);
      padding: 0 4px 0 6px;
      white-space: nowrap;
    }

    .ql-link{
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 999px;
      text-decoration: none;
      font-weight: 650;
      font-size: 12.5px;
      color: var(--btnText);
      border: 1px solid rgba(155,110,255,0.26);
      background:
        linear-gradient(135deg,
          rgba(255,120,160,0.22),
          rgba(155,110,255,0.18),
          rgba(255,90,210,0.12));
      transition: transform 0.14s ease, filter 0.14s ease;
      white-space: nowrap;
    }
    .ql-link:hover{
      transform: translateY(-1px);
      filter: brightness(1.03);
    }

    @media (max-width: 760px){
      .quicklinks{
        left: 50%;
        right: auto;
        transform: translateX(-50%);
        top: 76px;
        flex-wrap: wrap;
        justify-content: center;
        border-radius: 18px;
        padding: 10px 12px;
      }
      .ql-label{ width: 100%; text-align: center; padding: 0; }
    }

    main{
      max-width: 980px;
      margin: 0 auto;
      padding: 22px 18px 70px; /* was 44px top; reduced because ribbon adds space */
      text-align: center;
    }

    h1{
      font-size: clamp(28px, 4.8vw, 54px);
      line-height: 1.06;
      margin: 18px 0 10px;
      letter-spacing: -0.02em;
    }

    .sub{
      margin: 0 auto 22px;
      max-width: 640px;
      color: var(--muted);
      font-size: 16px;
    }

    .grid{
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 16px;
      margin-top: 12px;
    }

    @media (max-width: 760px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      text-align: left;
      border-radius: 22px;
      padding: 22px;
      border: 1px solid var(--border);
      background: var(--surface);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
      transition: transform 0.16s ease, box-shadow 0.16s ease, border-color 0.16s ease;
    }

    .card:hover{
      transform: translateY(-2px);
      box-shadow: 0 24px 55px rgba(22, 10, 35, 0.13);
    }

    .card::before{
      content:"";
      position:absolute;
      inset:-80px -90px auto auto;
      width: 230px;
      height: 230px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%,
        rgba(255,120,160,0.40),
        rgba(155,110,255,0.28),
        rgba(255,90,210,0.18),
        transparent 62%);
      filter: blur(2px);
      pointer-events: none;
    }

    .card::after{
      content:"";
      position:absolute;
      left:-120px;
      bottom:-140px;
      width: 260px;
      height: 260px;
      border-radius: 999px;
      background: radial-gradient(circle at 60% 40%,
        rgba(255,80,90,0.24),
        rgba(255,120,160,0.18),
        transparent 62%);
      pointer-events: none;
    }

    .card > *{ position: relative; z-index: 1; }

    .book-title{
      margin: 0 0 6px;
      font-size: 20px;
      font-weight: 650;
      letter-spacing: -0.01em;
    }

    .book-meta{
      margin: 0 0 16px;
      color: var(--muted);
      font-size: 14px;
    }

    .btn{
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 12px 14px;
      border-radius: 14px;
      text-decoration: none;
      font-weight: 650;
      color: var(--btnText);
      border: 1px solid rgba(155,110,255,0.30);
      background:
        linear-gradient(135deg,
          rgba(255,120,160,0.26),
          rgba(155,110,255,0.20),
          rgba(255,90,210,0.14));
      transition: transform 0.14s ease, filter 0.14s ease;
    }

    .btn:hover{
      transform: translateY(-1px);
      filter: brightness(1.03);
    }

    .arrow{
      font-weight: 800;
      font-size: 18px;
      line-height: 1;
      margin-top: -1px;
    }

    .card.book{
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .book-content{
      flex: 1;
      min-width: 0;
    }

    .book-art{
      width: 120px;
      height: 120px;
      border-radius: 18px;
      overflow: hidden;
      flex: 0 0 auto;
      background: rgba(255,255,255,0.35);
      border: 1px solid rgba(0,0,0,0.08);
      box-shadow: 0 10px 24px rgba(0,0,0,0.10);
    }

    .book-art img{
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    @media (max-width: 520px){
      .card.book{ flex-direction: column; align-items: stretch; }
      .book-art{
        width: 100%;
        height: auto;
        aspect-ratio: 2 / 3;
        border-radius: 18px;
      }
      .book-art img{
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
      }
    }

    /* ===== NEW: Auth row (Login / Logout only) ===== */
    .authRow{
      margin: 14px 0 6px;
      display:flex;
      gap:10px;
      justify-content:center;
      flex-wrap:wrap;
    }

    /* make logout look slightly calmer */
    .btn.secondary{
      background: rgba(255,255,255,0.75);
      border-color: rgba(140,120,160,0.20);
      color: rgba(26,26,31,0.82);
    }
  </style>
</head>

<body>
  <header class="banner">
    <a class="banner-link" href="https://riashandilya-svg.github.io/riaomshandilya/">Ria Om Shandilya</a>
  </header>

  <!-- NEW: Welcome ribbon lives here -->
  <div class="welcome-wrap">
    <div id="welcomeRibbon" class="welcome-ribbon" aria-live="polite">
      <span class="welcome-title">Welcome</span>
      <span class="welcome-name" id="userBox"></span>
    </div>
  </div>

  <!-- NEW: Quick links pill (Dashboard + Verify Book) -->
  <div id="quickLinks" class="quicklinks" aria-label="Quick links">
    <span class="ql-label">Quick links</span>
    <a id="dashboardLink" class="ql-link" href="./dashboard.html">ðŸŽµ Dashboard</a>
    <a id="verifyLink" class="ql-link" href="./verify-book.html">ðŸ“š Verify Book</a>
  </div>

  <main>
    <h1>Pick a book</h1>
    <p class="sub">Choose a mood, then pick a song inside.</p>

    <!-- Auth row now only has Login / Logout -->
    <div class="authRow" id="authBox">
      <a id="loginLink" class="btn" href="./login.html">Login</a>
      <button id="logoutBtn" class="btn secondary" style="display:none;" type="button">Logout</button>
    </div>

    <section class="grid">
      <div class="card book soulful">
        <div class="book-content">
          <h2 class="book-title">1. Soulful Bollywood Melodies</h2>
          <p class="book-meta">Slow, expressive pieces</p>
          <a class="btn" href="soulfulindex.html">Open <span class="arrow">â†’</span></a>
        </div>
        <div class="book-art">
          <img src="Soulful.jpg" alt="Soulful book cover">
        </div>
      </div>

      <div class="card book peppy">
        <div class="book-content">
          <h2 class="book-title">2. Peppy Bollywood Melodies</h2>
          <p class="book-meta">Upbeat, energetic tunes</p>
          <a class="btn" href="peppyindex.html">Open <span class="arrow">â†’</span></a>
        </div>
        <div class="book-art">
          <img src="peppy.jpg" alt="Peppy book cover">
        </div>
      </div>

      <div class="card book romantic">
        <div class="book-content">
          <h2 class="book-title">3. Romantic Bollywood Melodies</h2>
          <p class="book-meta">Warm, lyrical songs</p>
          <a class="btn" href="romanticindex.html">Open <span class="arrow">â†’</span></a>
        </div>
        <div class="book-art">
          <img src="romantic.jpg" alt="Romantic book cover">
        </div>
      </div>

      <div class="card book classic">
        <div class="book-content">
          <h2 class="book-title">4. Classic Bollywood Melodies</h2>
          <p class="book-meta">Golden-era favorites</p>
          <a class="btn" href="classicindex.html">Open <span class="arrow">â†’</span></a>
        </div>
        <div class="book-art">
          <img src="classic.jpg" alt="Classic book cover">
        </div>
      </div>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <script>
    const SUPABASE_URL = "https://lyqpxcilniqzurevetae.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx5cXB4Y2lsbmlxenVyZXZldGFlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk1NDAyMTQsImV4cCI6MjA4NTExNjIxNH0.40ZbAatkMBFHacQGCpiNYpjcKQoZik-Xvqx3bG46x7c";
    const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    async function renderAuthUI() {
      const { data: { session } } = await sb.auth.getSession();

      const loginLink = document.getElementById("loginLink");
      const logoutBtn = document.getElementById("logoutBtn");

      const welcomeRibbon = document.getElementById("welcomeRibbon");
      const userBox = document.getElementById("userBox");

      const quickLinks = document.getElementById("quickLinks");
      const dashboardLink = document.getElementById("dashboardLink");
      const verifyLink = document.getElementById("verifyLink");

      if (session && session.user) {
        const userId = session.user.id;

        const { data: profile, error } = await sb
          .from("profiles")
          .select("display_name, setup_completed")
          .eq("id", userId)
          .single();

        if (error) console.log("profile fetch error:", error);

        if (profile && profile.setup_completed === false) {
          window.location.href = "./setup.html";
          return;
        }

        const displayName = (profile && profile.display_name) ? profile.display_name : "there";

        // Welcome ribbon (between banner and title)
        userBox.textContent = displayName;
        welcomeRibbon.style.display = "inline-flex";

        // Auth buttons
        logoutBtn.style.display = "inline-flex";
        loginLink.style.display = "none";

        // Quick links pill
        quickLinks.style.display = "flex";
        dashboardLink.style.display = "inline-flex";
        verifyLink.style.display = "inline-flex";

      } else {
        welcomeRibbon.style.display = "none";
        quickLinks.style.display = "none";

        logoutBtn.style.display = "none";
        loginLink.style.display = "inline-flex";
      }
    }

    document.getElementById("logoutBtn").addEventListener("click", async () => {
      await sb.auth.signOut();
      await renderAuthUI();
    });

    sb.auth.onAuthStateChange(() => {
      renderAuthUI();
    });

    renderAuthUI();
    setTimeout(renderAuthUI, 800);
  </script>
</body>
</html>
